#ODE

>[!definition] 恰当方程
>考虑[[常微分方程|ODE]]
>$$P(x,y)\d x+Q(x,y)\d y=0\tag{E}$$
>若存在一个[[微分|可微]]函数$\Phi(x,y)$使得其[[Fréchet微分|全微分]]为
>$$\d\Phi(x,y)=P(x,y)\d x+Q(x,y)\d y$$
>则称(E)为**恰当方程**(exact equation). $\Phi(x,y)$称为一个**原函数**.

##### 解法

1. 由[[偏微分]]的定义, 显然有
$$\d\Phi(x,y)=\frac{\p\Phi}{\p x}\d x+\frac{\p\Phi}{\p y}\d y$$
从而恰当方程(E)有解当且仅当
$$P(x,y)=\frac{\p\Phi}{\p x},\quad Q(x,y)=\frac{\p\Phi}{\p y}$$
2. 此时, 方程化为全微分的形式
$$\d\Phi(x,y)=P(x,y)\d x+Q(x,y)\d y=0$$
于是
$$\Phi(x,y)=C$$
就是(E)的通解.
3. 恰当方程没有特解, 若$y(x)$是解, 则$\d\Phi(x,y(x))=C$, 从而$y=y(x)$包含在通解中.

>[!ex] 例1
>解ODE
>$$2xy^3\d x+3x^2y^2\d y=0$$

>[!proof]
>注意到当$\Phi(x,y)=x^2y^3$时
>$$\frac{\p\Phi}{\p x}=2xy^3,\quad \frac{\p\Phi}{\p y}=3x^2y^2$$
>因此
>$$\boxed{x^2y^3=C}$$
>就是ODE的通解.

然而, 显然不是所有人都注意力这么惊人. 我们需要解决的问题很显然可以概括为以下两件事:
1. 如何判断一个方程是否是恰当方程?
2. 如何求恰当方程的原函数?

>[!theorem] 定理1 (恰当方程判定定理)
>设函数$P(x,y)$和$Q(x,y)$在开区域$R$上一次连续, 且有连续的一阶偏导数$\p P/\p y$和$\p Q /\p x$, 则
>$$P(x,y)\d x+Q(x,y)\d y=0$$
>是恰当方程当且仅当恒等式
>$$\frac{\p P}{\p y}(x,y)\equiv\frac{\p Q}{\p x}(x,y)$$
>在$R$上成立, 且通解为
>$$\int_{x_0}^{x}{P(x,y)\,\d x}+\int_{y_0}^{y}{Q(x_0,y)\,\d y}=C$$
>或
>$$\int_{x_0}^{x}{P(x,y_0)\,\d x}+\int_{y_0}^{y}{Q(x,y)\,\d y}=C$$
>其中$(x_0,y_0)\in R$是任取的一点.

>[!proof]
>必要性. 设(E)是恰当方程, 则存在函数$\Phi$使得
>$$P(x,y)=\frac{\p\Phi}{\p x},\quad Q(x,y)=\frac{\p\Phi}{\p y}$$
>由此可得
>$$\frac{\p P}{\p y}=\frac{\p^2\Phi}{\p y\p x},\quad\frac{\p Q}{\p x}=\frac{\p^2\Phi}{\p x\p y}$$
>由连续性假设, 上述两个混合偏导数连续, 从而可以改变求偏导的顺序
>$$\frac{\p^2\Phi}{\p y\p x}=\frac{\p^2\Phi}{\p x\p y}$$
>从而
>$$\frac{\p P}{\p y}(x,y)\equiv\frac{\p Q}{\p x}(x,y)$$
>充分性. 设
>$$\frac{\p P}{\p y}(x,y)\equiv\frac{\p Q}{\p x}(x,y)$$
>成立, 下面构造一个可微函数$\Phi(x,y)$满足
>$$P(x,y)=\frac{\p\Phi}{\p x},\quad Q(x,y)=\frac{\p\Phi}{\p y}$$
>为了使前半成立, 可取
>$$\Phi(x,y)=\int_{x_0}^{x}{P(x,y)\,\d x}+\psi(y)$$
>其中$\psi(y)$待定, 代入后半得到
>$$\begin{aligned}
\frac{\p \Phi}{\p y}=&\frac{\p}{\p y}\left(\int_{x_0}^{x}{P(x,y)\,\d x}+\psi(y)\right)\\
=&\int_{x_0}^{x}{\frac{\p}{\p y}P(x,y)\,\d x}+\dd y{}\psi(y)\\
=&\int_{x_0}^{x}{\frac{\p}{\p y}Q(x,y)\,\d x}+\dd y{}\psi(y)\\
=&Q(x,y)-Q(x_0,y)+\dd y{}\psi(y)
\end{aligned}$$
>为了使得后半成立, 必有$Q(x_0,y)=\d\psi(y)/\d y$, 从而只需取
>$$\psi(y)=\int_{y_0}^{y}{Q(x_0,y)\,\d y}$$
>这样就找到了满足条件的函数
>$$\Phi(x,y)=\int_{x_0}^{x}{P(x,y)\,\d x}+\int_{y_0}^{y}{Q(x_0,y)\,\d y}$$
>类似地可以构造另一个函数(只需调换求$x,y$顺序)
>$$\Phi(x,y)=\int_{x_0}^{x}{P(x,y_0)\,\d x}+\int_{y_0}^{y}{Q(x,y)\,\d y}$$

>[!ex] 例2
>解ODE
>$$(y-3x^2)\d x-(4y-x)\d y=0$$

>[!proof]
>显然方程是恰当方程, 因为
>$$\frac{\p P}{\p y}=\frac{\p Q}{\p y}=1$$
>其中$P=y-3x^2,Q=x-4y$. 显然
>$$\Phi(x,y)=\int_{0}^{x}{y-3x^2\,\d x}-\int_{0}^{y}{4y\,\d y}=xy-x^3-2y^2$$
>从而通解为
>$$\boxed{xy-x^3-2y^2=C}$$
