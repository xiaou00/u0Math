#ODE 

>[!definition] 一阶线性微分方程
>形如
>$$\dd xy+p(x)y=q(x)\tag{E1}$$
>的[[常微分方程|ODE]]称为**一阶线性微分方程**(1st-order linear differential equation), 其中$p(x),q(x)$是开集$U$上的[[连续映射|连续函数]], 而称方程
>$$\dd xy+p(x)y=0\tag{E2}$$
>为(E1)对应的**一阶齐次线性微分方程**(1st-order homogeneous linear differential equation). 若$q(x)\ne0$, 也称(E1)是**非齐次的**.

##### 一阶齐次线性方程的解法

显然(E2)是[[变量分离方程]], 我们可以将其改写为
$$\frac 1y\d y+p(x)\d x=0$$

从而通解为
$$\ln|y|+\int{p(x)\,\d x}=C_1$$
即
$$y=C\e^{-\int{p(x)\,\d x}}\quad C\in\R$$
这个形式包含了解$y=0$. 这样我们就得到了(E2)的"求根公式":
$$y=\phi_C(x)=C\e^{-\int{p(x)\,\d x}}\tag{S1}$$

##### 一阶非齐次线性微分方程解法 - 常数变易法(Lagrange)

要求(E1)的解, 我们先求出(E2)的解, 并将常数换成待定函数$K(x)$:
$$y=K(x)\e^{-\int{p(x)\,\d x}}\tag{I}$$
代入(E1)有
$$\dd x{}K(x)\e^{-\int{p(x)\,\d x}}=q(x)$$
从而得出
$$K(x)=\int{q(x)\e^{\int{p(x)\,\d x}}\,\d x}+C$$
代回(I)有
$$y=\e^{-\int{p(x)\,\d x}}\left(C+\int{q(x)\e^{\int{p(x)\,\d x}}\,\d x}\right)$$
展开得
$$y=\phi_C(x)+\e^{-\int{p(x)\,\d x}}\int{q(x)\e^{\int{p(x)\,\d x}}\,\d x}\tag{S2}$$
其中$\phi_C(x)$是齐次线性微分方程组的解(S1). 更严谨地(也更方便), 我们经常用变限积分替代不定积分(这玩意有点神秘).
$$y=\e^{-\int_{x_0}^x{p(t)\,\d t}}\left(C+\int_{x_0}^x{q(s)\e^{\int_{x_0}^s{p(t)\,\d t}}\,\d s}\right),\quad x\in U$$
此形式容易推出[[初值问题|IVP]]
$$\dd xy+p(x)y=p(x),\quad y(x_0)=y_0$$
的解为
$$y=\e^{-\int_{x_0}^x{p(t)\,\d t}}\left(y_0+\int_{x_0}^x{q(s)\e^{\int_{x_0}^s{p(t)\,\d t}}\,\d s}\right),\quad x\in U$$
##### 解的性质

>[!proposition] 性质
>1. 齐次线性方程(E2)的解或恒为0, 或恒不为0.
>2. 线性方程的解在定义域上总是整体存在.
>3. 齐次线性方程(E2)的任意有限多个解的线性组合依然是其解.
>4. 齐次线性方程(E2)的任一解与非齐次线性方程(E1)的任一解的和是(E1)的解.
>5. 非齐次线性方程(E1)的任意两个解之差必然是齐次线性方程(E2)的解.
>6. 非齐次线性方程(E1)的任一解与对应的齐次线性方程(E2)的通解之和构成(E1)的通解.
>7. 线性方程的初值问题的解存在且唯一.

>[!ex] 例1
>求ODE
>$$\dd xy+\frac1xy=x^3\quad x\ne 0$$

>[!solution]
>对应的齐次线性方程
>$$\dd xy+\frac1xy=0$$
>的通解为
>$$y=\frac Cx,\quad x\ne 0$$
>从而$\phi_C(x)=\frac Cx$. 设待定函数
>$$y=\frac{K(x)}{x}$$
>代入原方程得
>$$\dd x{(K(x)/x)}+\frac1{x^2}K(x)=x^3$$
>从而
>$$\frac1x\dd x{K(x)}+K(x)\dd x{}\frac1x+\frac1{x^2}K(x)=x^3$$
>即
>$$\frac1x\dd x{K(x)}-\frac1{x^2}K(x)+\frac1{x^2}K(x)=x^3\implies \dd x{K(x)}=x^4\implies K(x)=\frac15 x^5+C$$
>从而通解为
>$$y=\frac15x^4+\frac Cx,\quad x\ne 0$$

