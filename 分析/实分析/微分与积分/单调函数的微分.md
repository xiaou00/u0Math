#分析 

>[!theorem] 单调函数微分定理
>若$f(x)$是定义在$[a,b]$上的[[保序映射|单调]][[实值函数]], 则$f$[[几乎处处]][[微分|可微]]. 且不等式
>$$\int_{a}^{b}{\dd{x}{f(x)}\,\d x}\le f(b)-f(a)$$
>成立.

>[!proof]
>我们先证明对于a.e.的$x\in(a,b)$, 其四个[[Dini导数]]相等, 即
>$$\D_-f(x)=\D^-f(x)=\D_+f(x)=\D^+f(x)$$
>为此只需要证明下面两个点集
>$$E_1=\set{x\in[a,b]:\D^+f(x)>\D_-f(x)}$$
>$$E_2=\set{x\in[a,b]:\D^-f(x)>\D_+f(x)}$$
>均为[[零测集]]即可, 即证明$m(E_1)=0$, 只需推广变换$-f$, 就有$\D^+(-f)=-\D_+(f)$和$\D^ -(-f)=-\D_-(f)$, 从而推出$m(E_2)=0$.
>我们设$\Q_+$为正有理数集, 并对$E_1$作如下分解:
>$$E_1=\bigcup_{r,s\in\Q_+}{\set{x\in[a,b]:\D^+f(x)>r>s>\D_-f(x)}}$$
>现在对任给的$r,s$, 我们记
>$$A=\set{x\in[a,b]:\D^+f(x)>r>s>\D_-f(x)}$$
>则$m(E_1)=0$的证明可以归结为证明$m(A)=0$ (可数可加性). 不妨作开集$G\supset A$, 使得$m(G)<(1+\epsilon)m^*(A)$. 对于任意点$x\in A$, 由于$\D_-f(x)<s$, 故存在$h>0$使得
>$$\frac{f(x-h)-f(x)}{-h}<s\tag{I}$$
>其中$h$可以取充分小, 不妨假定$[x-h,x]\subset G$, 这样全体形如$[x-h,x]$的全体构成$A$的一个$G$的[[Vitali覆盖引理|Vitali覆盖]]. 由[[Vitali覆盖引理]], 对任给的$\epsilon>0$, 存在互不相交的区间有限组
>$$[x_1-h_1,x_1],[x_2-h_2,x_2],\ldots,[x_p-h_p,x_p]$$
>使得
>$$m^*\left(A\cap\bigcup_{j=1}^p{[x_j-h_j,x_j]}\right)>m^*(A)-\epsilon\tag{II}$$
>并且有
>$$\sum_{j=1}^p{h_j}\le m(G)<(1+\epsilon)m^*(A)\tag{III}$$
>因为每一个$\set{x_j-h_j,x_j}$都满足(I), 于是
>$$f(x_j)-f(x_j-h_j)<sh_j,\quad j=1,2,\ldots,p$$
>再考虑(II)有
>$$\sum_{j=1}^p[f(x_j)-f(x_j-h_j)]<s(1+\epsilon)m^*(A)\tag{IV}$$
>又记
>$$B=A\cap\bigcup_{j=1}^p{(x_j-h_j,x_j)}$$
>因为对任意$y\in B$, $\D^+f(y)>r$, 从而存在$k>0$, 使得$[y,y+k]$包含于某个$(x_j-h_j,x_j)$内, 且
>$$\frac{f(y+k)-f(y)}{k}>r\tag{V}$$
>其中$k$可以取充分小, 这样$[y,y+k]$的全体也构成Vitali覆盖, 再应用Vitali覆盖引理, 可知互不相交的区间有限组
>$$[y_1,y_1+k_1],[y_2,y_2+k_2],\ldots,[y_q,y_q+k_q]$$
>使得
>$$\sum_{i=1}^q{k_i}>m^*(B)-\epsilon$$
>由于每个$\set{y_i,y_i+k_i}$都满足(V), 从而
>$$f(y_i+k_i)-f(y_i)>rk_i$$
>由(II)得
>$$\sum_{i=1}^q{[f(y_i+k_i)-f(y_i)]}>r(m^*(A)-2\epsilon)\tag{VI}$$
>注意到$f(x)$是递增函数, 以及$[y_i,y_i+k_i]$含于某个$(x_j-h_j,x_j)$内, 可知
>$$\sum_{i=1}^q{(f(y_i+k_i)-f(y_i))}\le\sum_{i=1}^p{(f(x_j)-f(x_j-h_j))}$$
>由(IV)和(VI), 我们得到
>$$r(m^*(A)-2\epsilon)<s(1+\epsilon)m^*(A)$$
>由$\epsilon$的任意性, 上式变为1$rm^*(A)\le sm^*(A)$. 这说明$m^*(A)=0$, 否则与$r>s$矛盾.
>下面我们证明不等式成立, 由上所述, $\dd xf$在$[a,b]$上a.e.有定义, 由$f(x)$的单增性, $\dd xf\ge0$, a.e. 令
>$$f_n(x)=n\left(f\left(x+\frac1n\right)-f(x)\right),\quad x\in[a,b]$$
>不妨令当$x>b$时, $f(x)=f(b)$, 易知
>$$f_n(x)\ge0,\quad\lim_{n\to\infty}{f_n(x)}=\dd xf(x),\quad \mathrm{a.e.}\, x\in[a,b]$$
>由[[Fatou引理]], $$\begin{aligned}
\int_{a}^{b}{\dd xf(x)\,\d x}&\le\liminf_{n\to\infty}{\int_{a}^{b}{f_n(x)\,\d x}}\\
&\le\liminf_{n\to\infty}{n\int_{a}^{b}{f\left(x+\frac{1}{n}\right)-f(x)\,\d x}}\\
&=\liminf_{n\to\infty}{\left(n\int_{b}^{b+1/n}{f(x)\,\d x}-n\int_{a}^{a+1/n}{f(x)\,\d x}\right)}\\
&=\liminf_{n\to\infty}{\left(f(b)-n\int_{a}^{a+1/n}{f(x)\,\d x}\right)}\\
&\le f(b)-f(a)
\end{aligned}$$
>从而原不等式成立, 立即得出几乎处处有限成立, 从而$f(x)$几乎处处可微.

